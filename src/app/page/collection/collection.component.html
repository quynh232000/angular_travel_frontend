<main class="container" style="padding-top: 90px">
  <div class="pt-3">
    <nav style="--bs-breadcrumb-divider: '>'" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Trang chủ</a></li>
        <!-- <li class="breadcrumb-item"><a href="#">Nước ngoài</a></li> -->
        <li class="breadcrumb-item active" aria-current="page">
          Tìm kiếm tour
        </li>
      </ol>
    </nav>
  </div>
  <div class="row">
    <div class="col-md-3 h-fit fs-7 pe-4">
      <div class="border rounded-2 p-3">
        <div class="fw-bold border-bottom pb-2 mb-2 fs-6 text-primary d-flex justify-content-between align-items-center">
          <span>Chọn lọc theo</span>
        </div>
        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Loại hình tour</label>
          <select
            name=""
            class="form-control"
            id=""
            (change)="sortSelect()"
            [(ngModel)]="dataFilter.type"
          >
            <option value="">--Tất cả--</option>
            <option value="inside">Tour trong nước</option>
            <option value="ouside">Tour nước ngoài</option>
          </select>
        </div>
        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Điểm đi</label>
          <select
            name=""
            class="form-control"
            (change)="sortSelect()"
            [(ngModel)]="dataFilter.province_start_id"
          >
            <option value="">--Tất cả--</option>
            <option value="{{ item.id }}" *ngFor="let item of provinces">
              {{ item.name }}
            </option>
          </select>
        </div>
        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Điểm đến</label>
          <select
            name=""
            class="form-control"
            (change)="sortSelect()"
            [(ngModel)]="dataFilter.province_end_id"
          >
            <option value="">--Tất cả--</option>
            <option value="{{ item.id }}" *ngFor="let item of provinces">
              {{ item.name }}
            </option>
          </select>
        </div>
        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Số ngày</label>
          <div class="row">
            <div class="col-6 mb-2">
              <label
                for="date1"
                class="btn btn-outline-primary border-gray fs-7 text-gray w-100 {{dataFilter.number_of_day =='0-3'?'bg-primary text-white':''}}"
                >1-3 ngày</label
              >
              <input id="date1" type="radio" hidden (change)="sortSelect()" [(ngModel)]="dataFilter.number_of_day" value="0-3"/>
            </div>
            <div class="col-6">
              <label
                for="date2"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.number_of_day =='4-7'?'bg-primary text-white':''}}"
                >4-7 ngày</label
              >
              <input id="date2" type="radio" hidden (change)="sortSelect()" [(ngModel)]="dataFilter.number_of_day" value="4-7" />
            </div>
            <div class="col-6">
              <label
                for="date3"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.number_of_day =='8-14'?'bg-primary text-white':''}}"
                >8-14 ngày</label
              >
              <input id="date3" type="radio" hidden (change)="sortSelect()" [(ngModel)]="dataFilter.number_of_day" value="8-14"/>
            </div>
            <div class="col-6">
              <label
                for="date4"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.number_of_day =='15'?'bg-primary text-white':''}}"
                >> 14 ngày</label
              >
              <input id="date4" type="radio" hidden (change)="sortSelect()" [(ngModel)]="dataFilter.number_of_day" value="15"/>
            </div>
          </div>
        </div>
        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Ngày đi</label>
          <input type="date" class="form-control" (change)="sortSelect()" [(ngModel)]="dataFilter.date_start"/>
        </div>
       

        <div class="my-2">
          <label for="" class="fw-bold text-primary-1"
            >Ngân sách của bạn (mỗi đêm)</label
          >
          <input
            type="range"
            class="form-range"
            min="0"
            max="30000000"
            (change)="sortSelect()"
            name="price"
            [(ngModel)]="dataFilter.price"
            step="100000"
            id="customRange3"
          />
          <div>
            <div class="d-flex gap-2 align-items-center">
              <span class="text-gray fs-7">{{dataFilter.price |formatprice}}</span>
              <span>-</span>
              <span class="text-gray fs-7">30.000.000 đ</span>
            </div>
          </div>
        </div>

        <div class="my-2">
          <label for="" class="fw-bold text-primary-1">Dòng tour</label>
          <div class="row">
            <div class="col-6 mb-2">
              <label
                for="tour_pakage1"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.tour_pakage =='luxury'?'bg-primary text-white':''}}"
                >Cao cấp</label
              >
              <input id="tour_pakage1" type="radio" hidden (change)="sortSelect()" [(ngModel)]="dataFilter.tour_pakage"  value="luxury"/>
            </div>

            <div class="col-6">
              <label
                for="tour_pakage2"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.tour_pakage =='standard'?'bg-primary text-white':''}}"
                >Tiêu chuẩn</label
              >
              <input id="tour_pakage2" type="radio" hidden  (change)="sortSelect()" [(ngModel)]="dataFilter.tour_pakage"   value="standard"/>
            </div>
            <div class="col-6">
              <label
                for="tour_pakage3"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.tour_pakage =='saving'?'bg-primary text-white':''}}"
                >Tiết kiệm</label
              >
              <input id="tour_pakage3" type="radio" hidden  (change)="sortSelect()" [(ngModel)]="dataFilter.tour_pakage"  value="saving"/>
            </div>
            <div class="col-6">
              <label
                for="tour_pakage4"
                class="btn btn-outline-primary border-gray text-gray w-100 fs-7 {{dataFilter.tour_pakage =='affordable'?'bg-primary text-white':''}}"
                >Giá tốt</label
              >
              <input id="tour_pakage4" type="radio" hidden  (change)="sortSelect()" [(ngModel)]="dataFilter.tour_pakage"  value="affordable"/>
            </div>
          </div>
        </div>

        <div class="my-2">
          <div class="text-center border mt-3 p-2 rounded-3 text-white cursor-pointer hover-bg-primary fs-7 w-100 btn btn-warning" (click)="resetFilter()">Đặt lại</div>
        </div>
      </div>
    </div>

    <div class="col-md-9">
      <div class="d-flex justify-content-between align-items-center text-gray">
        <div class="fs-7">
          Tìm thấy
          <strong class="text-primary fs-6">{{ meta.total }}</strong> tours cho
          Quý Khách.
        </div>
        <div class="d-flex align-items-center gap-2 fs-7">
          <span>Sắp xếp theo</span>
          <div>
            <select
              class="form-control"
              name=""
              (change)="sort()"
              [(ngModel)]="dataFilter.order_by"
              id=""
            >
              <option value="">--Chọn--</option>
              <option value="created_at-desc">Theo ngày</option>
              <option value="price-desc">Theo giá</option>
            </select>
          </div>
        </div>
      </div>

      <div class="py-4">
        <div class="row">
          <div
            class="col-12 col-sm-6 col-xl-4 mb-4"
            *ngFor="let item of listTours"
          >
          <div class="card card-hover position-relative">
            <div class="position-absolute start-0 top-0 p-2">
              <div *ngIf="item.percent_sale>0" class="bg-warning px-2 py-1 rounded-2 text-white fw-bold">
                Sale
              </div>
            </div>
            <div class="" style="height: 260px">
              <img
                src="{{item.thumnail}}"
                class="card-img-top h-100 object-fit-cover"
                alt="{{item.title}}"
              />
            </div>
            <div class="card-body">
              <span class="fs-7">{{item.date_start |formatdate}} - {{item.number_of_day}} ngày</span>
              <h5 class="card-title text-primary fw-bold mt-1 card-name">
                <a [routerLink]="['/tour',item.slug]" class="text-primary-1"
                  >{{item.title}}</a
                >
              </h5>
              <span class="card-text fs-7"
                >Nơi khởi hành: {{item.province_start.name}}</span
              >
              <div class="mt-2" style="height: 30px;"><del *ngIf="item.percent_sale >0">Giá: {{(item.price/(100-item.percent_sale)*100)|formatprice}} đ</del></div>
              <div class="d-flex text-warning justify-content-between">
                <span class="fw-bold fs-5">{{item.percent_sale>0 ?'Còn':'Chỉ'}}: {{item.price|formatprice}} đ</span>
                <div class="bg-warning text-light px-2 py-1 fs-7 rounded-4" *ngIf="item.percent_sale >0">
                  {{item.percent_sale}}% GIẢM
                </div>
              </div>
              <div class="d-flex justify-content-between gap-2 my-2">
                <a [routerLink]="['/booking',item.slug]"  class="btn btn-danger flex-1"
                  >Đặt ngay</a
                >
                <a [routerLink]="['/tour',item.slug]" class="btn btn-outline-primary"
                  >Xem chi tiết</a
                >
              </div>
              <div class="d-flex align-items-center justify-content-between mt-4">
                <span class="fs-7 fw-bold text-primary">
                  <i class="fa-solid fa-circle-plus"></i>
                  <span class="cursor-pointer" (click)="addCompare(item)">Thêm vào so sánh</span>
                </span>
                <div class="d-flex align-items-center gap-2">
                  <div class="fs-7 fw-bold text-decoration-underline">
                    Số chỗ còn
                  </div>
                  <span class="text-danger fw-bold fs-5">{{item.quantity}}</span>
                </div>
              </div>
            </div>
          </div>
          </div>
          <div class="col-12 text-center text-danger py-5" *ngIf="listTours.length ==0">
            <div>
              <img width="84" src="assets/images/icons/cancel.png" alt="">
              <div class="mt-3">
                Không tìm thấy kết quả nào!
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-center pt-4" *ngIf="listTours.length !=0">
        <nav aria-label="Page navigation example">
          <ul class="pagination">
            <li class="page-item" (click)="changePage(meta.current_page - 1)">
              <button class="page-link" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </button>
            </li>
            <li
              class="page-item"
              *ngFor="let pageNum of pages"
              (click)="changePage(pageNum)"
            >
              <button
                class="page-link {{
                  pageNum == meta.current_page ? 'bg-primary text-white' : ''
                }}"
                href="#"
              >
                {{ pageNum }}
              </button>
            </li>

            <li class="page-item" (click)="changePage(meta.current_page + 1)">
              <button class="page-link" aria-label="Next" >
                <span aria-hidden="true">&raquo;</span>
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</main>
